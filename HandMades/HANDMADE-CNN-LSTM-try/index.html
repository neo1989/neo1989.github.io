<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="我读书少，你莫骗我。"><title>A Demo of the CNN LSTM | 愚苏记</title><link rel="stylesheet" type="text/css" href="https://cdn.staticfile.org/lxgw-wenkai-webfont/1.6.0/style.css"><link rel="stylesheet" type="text/css" href="../../css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="../../lib/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="../../lib/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="../../lib/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="../../lib/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="../../lib/jquery/3.4.0/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="../../favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="../../favicon.ico"><link rel="apple-touch-icon" href="../../apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="../../apple-touch-icon.png"><script><!-- hexo-inject:begin --><!-- hexo-inject:end -->var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = 'https://hm.baidu.com/hm.js?' + '96c862f2728296588ae9849f3bcb95db';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();</script><link rel="alternate" type="application/atom+xml" href="../../atom.xml"><meta name="generator" content="Hexo 7.1.1"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">A Demo of the CNN LSTM</h1><a id="logo" href="../../.">愚苏记</a><p class="description">To no avail but try.</p></div><div id="nav-menu"><a class="current" href="../../."><i class="fa fa-home"> Home</i></a><a href="../../archives/"><i class="fa fa-archive"> Archive</i></a><a href="../../about/"><i class="fa fa-user"> About</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-4-4"><div class="content_container no-padding-right"><div class="post"><h1 class="post-title">A Demo of the CNN LSTM</h1><div class="post-meta">Feb 15, 2023<span> | </span><span class="category"><a href="../../categories/HandMades/">HandMades</a></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 1.2k</span><span class="post-meta-item-text"> Words</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-hourglass-half"></i><span class="post-count"> 6</span><span class="post-meta-item-text"> Minutes</span></span></span></div><a class="disqus-comment-count" data-disqus-identifier="HandMades/HANDMADE-CNN-LSTM-try/" href="#disqus_thread"></a><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">Contents</div><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#The-Problem"><span class="toc-number">1.</span> <span class="toc-text">The Problem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CNN-LSTM"><span class="toc-number">2.</span> <span class="toc-text">CNN LSTM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#generate-examples"><span class="toc-number">3.</span> <span class="toc-text">generate_examples</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CNN-Model"><span class="toc-number">4.</span> <span class="toc-text">CNN Model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fit-and-evaluate-the-model"><span class="toc-number">5.</span> <span class="toc-text">fit and evaluate the model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#prediction"><span class="toc-number">6.</span> <span class="toc-text">prediction</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Further-Reading"><span class="toc-number">7.</span> <span class="toc-text">Further Reading</span></a></li></ol></div></div><div class="post-content"><blockquote>
<!-- hexo-inject:begin --><!-- hexo-inject:end --><p>The moving square video prediction problem is contrived to demonstrate the CNN LSTM. The problem involves the generation of a sequence of frames. In each image a line is drawn from left to right or right to left. Each frame shows the extension of the line by one pixel. The task is for the model to classify whether the line moved left or right in the sequence of frames.Technically, the problem is a sequence classification problem framed with a many-to-one prediction model.</p>
</blockquote>
<p>&quot;Moving Square Video Prediction&quot;是<a target="_blank" rel="noopener" href="https://machinelearningmastery.com/lstms-with-python/">《Long Short-Term Memory Networks With Python》</a> 这本书里的一个示例。我在这里做了一下扩展，将其变成一个多分类问题。</p>
<h3 id="The-Problem">The Problem</h3>
<p>问题定义为一个帧序列，从边缘开始每多一帧就增加一个像素点，以展示朝某个方向延伸的一条线（从上到下，从下到上，从左到右，从右到左）。<br>
模型的任务就是预测这条线是如何运动的。<br>
很明显，这就是一个many-to-one的分类任务。输入帧序列，输出单个标签（<a target="_blank" rel="noopener" href="http://karpathy.github.io/2015/05/21/rnn-effectiveness/">图片来源</a>）。</p>
<p><img src="//s3.mindex.xyz/blog/Notes/faf00c2f0f3277b8c0c8e95a7d504552.png" alt="Recurrent Neural Networks"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 代码示例</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint, random, choice</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot</span><br><span class="line"></span><br><span class="line">directions = [<span class="string">&quot;Up&quot;</span>, <span class="string">&quot;Down&quot;</span>, <span class="string">&quot;Left&quot;</span>, <span class="string">&quot;Right&quot;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">next_frame</span>(<span class="params">last_step, last_frame, row=<span class="literal">None</span>, col=<span class="literal">None</span></span>):</span><br><span class="line">    lower = <span class="built_in">max</span>(<span class="number">0</span>, last_step-<span class="number">1</span>)</span><br><span class="line">    upper = <span class="built_in">min</span>(last_frame.shape[<span class="number">0</span>]-<span class="number">1</span>, last_step+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    step = randint(lower, upper)</span><br><span class="line"></span><br><span class="line">    frame = last_frame.copy()</span><br><span class="line">    <span class="keyword">if</span> row <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        frame[row, step] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> col <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        frame[step, col] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> frame, step</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_frames</span>(<span class="params">size</span>):</span><br><span class="line">    frames = <span class="built_in">list</span>()</span><br><span class="line"></span><br><span class="line">    frame = np.zeros((size, size))</span><br><span class="line">    step = randint(<span class="number">0</span>, size-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    towards = choice(directions)</span><br><span class="line">    <span class="keyword">if</span> towards <span class="keyword">in</span> [<span class="string">&quot;Up&quot;</span>, <span class="string">&quot;Down&quot;</span>]:</span><br><span class="line"></span><br><span class="line">        down = <span class="number">1</span> <span class="keyword">if</span> towards == <span class="string">&quot;Down&quot;</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        row = <span class="number">0</span> <span class="keyword">if</span> down <span class="keyword">else</span> size-<span class="number">1</span></span><br><span class="line">        frame[row, step] = <span class="number">1</span></span><br><span class="line">        frames.append(frame)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, size):</span><br><span class="line">            row = i <span class="keyword">if</span> down <span class="keyword">else</span> size-<span class="number">1</span>-i</span><br><span class="line">            frame, step = next_frame(step, frame, row=row)</span><br><span class="line">            frames.append(frame)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        right = <span class="number">1</span> <span class="keyword">if</span> towards == <span class="string">&quot;Right&quot;</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        col = <span class="number">0</span> <span class="keyword">if</span> right <span class="keyword">else</span> size-<span class="number">1</span></span><br><span class="line">        frame[step, col] = <span class="number">1</span></span><br><span class="line">        frames.append(frame)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, size):</span><br><span class="line">            col = i <span class="keyword">if</span> right <span class="keyword">else</span> size-<span class="number">1</span>-i</span><br><span class="line">            frame, step = next_frame(step, frame, col=col)</span><br><span class="line">            frames.append(frame)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> frames, towards</span><br><span class="line"></span><br><span class="line">size = <span class="number">50</span></span><br><span class="line"></span><br><span class="line">frames, towards = build_frames(size)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Towards: <span class="subst">&#123;towards&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">pyplot.figure(figsize=[<span class="number">8</span>, <span class="number">8</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(size):</span><br><span class="line">    pyplot.subplot(size // <span class="number">10</span>, <span class="number">10</span>, i+<span class="number">1</span>)</span><br><span class="line">    pyplot.imshow(frames[i], cmap=<span class="string">&#x27;Greys&#x27;</span>)</span><br><span class="line">    ax = pyplot.gca()</span><br><span class="line">    ax.get_xaxis().set_visible(<span class="literal">False</span>)</span><br><span class="line">    ax.get_yaxis().set_visible(<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">pyplot.show()</span><br></pre></td></tr></table></figure>
<p><img src="//s3.mindex.xyz/blog/Notes/973e4cf02597baebd977e10eca8a6ce9.png" alt="显示运动方向为向上 (从左上到右下逐帧)"></p>
<h3 id="CNN-LSTM">CNN LSTM</h3>
<p>使用CNN层对输入数据进行特征提取, 使用LSTM来做序列预测。<br>
这种架构还被用于语音识别和自然语言处理问题，其中CNN被用作音频和文本输入数据上的特征提取器，以供LSTM使用。<br>
此架构适用于以下问题：</p>
<ul>
<li>在其输入中具有空间结构，例如 2D 结构或图像中的像素或句子，段落或文档中的单词的一维结构。</li>
<li>在其输入中具有时间结构，诸如视频中的图像的顺序或文本中的单词，或者需要生成具有时间结构的输出，诸如文本描述中的单词。</li>
</ul>
<p><img src="//s3.mindex.xyz/blog/Notes/e018c5595051507361a05e2ecb6aa01d.png" alt="卷积神经网络长短期记忆网络架构"></p>
<h3 id="generate-examples">generate_examples</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> LabelEncoder, OneHotEncoder</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># label encode</span></span><br><span class="line">label_encoder = LabelEncoder()</span><br><span class="line">label_encoded = label_encoder.fit_transform(directions)</span><br><span class="line">label_encoded = label_encoded.reshape(<span class="built_in">len</span>(directions), <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># one hot encode</span></span><br><span class="line">onehot_encoder = OneHotEncoder(sparse=<span class="literal">False</span>)</span><br><span class="line">onehot_encoder.fit(label_encoded)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_examples</span>(<span class="params">size, n_patterns</span>):</span><br><span class="line">    X, y = <span class="built_in">list</span>(), <span class="built_in">list</span>()</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n_patterns):</span><br><span class="line">        frames, towards = build_frames(size)</span><br><span class="line">        X.append(frames)</span><br><span class="line">        y.append(towards)</span><br><span class="line">    X = np.array(X).reshape(n_patterns, size, size, size, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    label_encoded = label_encoder.transform(np.array(y))</span><br><span class="line">    y = onehot_encoder.transform(label_encoded.reshape(<span class="built_in">len</span>(label_encoded), <span class="number">1</span>))</span><br><span class="line">    <span class="keyword">return</span> X, y</span><br></pre></td></tr></table></figure>
<h3 id="CNN-Model">CNN Model</h3>
<p>The Conv2D will interpret snapshots of the image (e.g. small squares) and the pooling layers will consolidate or abstract the interpretation.<br>
We will define a Conv2D as an input layer with 2 filters and a 2 × 2 kernel to pass across the input images. The use of 2 filters was found with some experimentation and it is convention to use small kernel sizes. The Conv2D will output 2 49 × 49 pixel impressions of the input.</p>
<p>Convolutional layers are often immediately followed by a pooling layer. Here we use a MaxPooling2D pooling layer with a pool size of 2 × 2, which will in effect halve the size of each filter output from the previous layer, in turn outputting two 24 × 24 maps.</p>
<p>The pooling layer is followed by a Flatten layer to transform the [24,24,2] 3D output from the MaxPooling2D layer into a one-dimensional 1,152 element vector…</p>
<p>We want to apply the CNN model to each input image and pass on the output of each input image to the LSTM as a single time step.<br>
We can achieve this by wrapping the entire CNN input model (one layer or more) in a TimeDistributed layer.</p>
<p>Next, we can define the LSTM elements of the model. We will use a single LSTM layer with 50 memory cells, configured after a little trial and error. The use of a TimeDistributed wrapper around the whole CNN model means that the LSTM will see 50 time steps, with each time step presenting a 1,152 element vector as input.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> keras.models <span class="keyword">import</span> Sequential</span><br><span class="line"><span class="keyword">from</span> keras.layers <span class="keyword">import</span> Conv2D</span><br><span class="line"><span class="keyword">from</span> keras.layers <span class="keyword">import</span> MaxPooling2D</span><br><span class="line"><span class="keyword">from</span> keras.layers <span class="keyword">import</span> LSTM</span><br><span class="line"><span class="keyword">from</span> keras.layers <span class="keyword">import</span> Dense</span><br><span class="line"><span class="keyword">from</span> keras.layers <span class="keyword">import</span> Flatten</span><br><span class="line"><span class="keyword">from</span> keras.layers <span class="keyword">import</span> TimeDistributed</span><br><span class="line"></span><br><span class="line">size = <span class="number">50</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># define the model</span></span><br><span class="line">model = Sequential()</span><br><span class="line">model.add(TimeDistributed(Conv2D(<span class="number">2</span>, (<span class="number">2</span>, <span class="number">2</span>), activation=<span class="string">&#x27;relu&#x27;</span>), input_shape=(<span class="literal">None</span>, size, size, <span class="number">1</span>)))</span><br><span class="line">model.add(TimeDistributed(MaxPooling2D(pool_size=(<span class="number">2</span>, <span class="number">2</span>))))</span><br><span class="line">model.add(TimeDistributed(Flatten()))</span><br><span class="line">model.add(LSTM(<span class="number">50</span>))</span><br><span class="line">model.add(Dense(<span class="built_in">len</span>(directions), activation=<span class="string">&#x27;softmax&#x27;</span>))</span><br><span class="line">model.<span class="built_in">compile</span>(loss=<span class="string">&#x27;binary_crossentropy&#x27;</span>, optimizer=<span class="string">&#x27;adam&#x27;</span>, metrics=[<span class="string">&#x27;acc&#x27;</span>])</span><br><span class="line"></span><br><span class="line">model.summary()</span><br></pre></td></tr></table></figure>
<p><img src="//s3.mindex.xyz/blog/Notes/22c2c8bfed7763a934fe6044eefac0e8.png" alt="Model Summary"></p>
<h3 id="fit-and-evaluate-the-model">fit and evaluate the model</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># fit model</span></span><br><span class="line">X, y = generate_examples(size, <span class="number">5000</span>)</span><br><span class="line">model.fit(X, y, batch_size=<span class="number">32</span>, epochs=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># evaluate model</span></span><br><span class="line">X, y = generate_examples(size, <span class="number">100</span>)</span><br><span class="line">loss, acc = model.evaluate(X, y, verbose=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;loss: <span class="subst">&#123;loss:<span class="number">.10</span>f&#125;</span> acc: <span class="subst">&#123;acc:<span class="number">.10</span>f&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="//s3.mindex.xyz/blog/Notes/f09f8a2296dd060ce612753e82a28c1f.png" alt="fit &amp; evaluate"></p>
<h3 id="prediction">prediction</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># prediction on new data</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    X, y = generate_examples(size, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    yhat = model.predict(X, verbose=<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;predict_i: <span class="subst">&#123;i&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(label_encoder.inverse_transform([np.argmax(y[<span class="number">0</span>, :])]), y)</span><br><span class="line">    <span class="built_in">print</span>(label_encoder.inverse_transform(np.array([np.argmax(yhat[<span class="number">0</span>, :])])), yhat)</span><br></pre></td></tr></table></figure>
<p><img src="//s3.mindex.xyz/blog/Notes/f757cfdf47d2ecf0da2a4fe6c9a09e38.png" alt="predictions"></p>
<h3 id="Further-Reading">Further Reading</h3>
<ul>
<li><a target="_blank" rel="noopener" href="https://keras.io/api">Keras API.</a></li>
<li><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1411.4389">Long-term Recurrent Convolutional Networks for Visual Recognition and Description, 2015.</a></li>
<li><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1411.4555">Show and Tell: A Neural Image Caption Generator, 2015.</a></li>
<li><a target="_blank" rel="noopener" href="https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/43455.pdf">Convolutional, Long Short-Term Memory, fully connected Deep Neural Networks, 2015.</a></li>
<li><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1508.06615">Character-Aware Neural Language Models, 2015.</a></li>
<li><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1506.04214">Convolutional LSTM Network: A Machine Learning Approach for Precipitation Nowcasting, 2015.</a></li>
</ul>
</div><iframe src="/donate/?AliPayQR=null&amp;WeChatQR=http://s3.mindex.xyz/mp/qrcode-s.jpg&amp;GitHub=http://github.com/neo1989&amp;BTCQR=null&amp;BTCKEY=null&amp;PayPal=null" style="overflow-x:hidden; overflow-y:hidden; border:0xp none #fff; min-height:240px; width:100%;" frameborder="0" scrolling="no"></iframe><div><ul class="post-copyright"><li class="post-copyright-author"><strong>Author: </strong>尼欧</li><li class="post-copyright-link"><strong>Blog Link: </strong><a href="/HandMades/HANDMADE-CNN-LSTM-try/">https://neo1989.net/HandMades/HANDMADE-CNN-LSTM-try/</a></li><li class="post-copyright-license"><strong>Copyright Declaration: </strong>转载请声明出处。</li></ul></div><br><div class="tags"><a href="../../tags/Coder/">Coder</a><a href="../../tags/AI/">AI</a><a href="../../tags/DL/">DL</a></div><div class="post-nav"><a class="pre" href="../../Way2AI/Way2AI-gpt-history/">ChatGPT核心技术的进化之路</a><a class="next" href="../../Notes/NOTE-why-has-nobody-told-me-this-before/">《为什么没人早点告诉我》</a></div><div id="disqus_thread"><div class="btn_click_load"><button class="disqus_click_btn">阅读评论（请确保 Disqus 可以正常加载）</button></div><script type="text/javascript">var disqus_config = function () {
    this.page.url = 'https://neo1989.net/HandMades/HANDMADE-CNN-LSTM-try/';
    this.page.identifier = 'HandMades/HANDMADE-CNN-LSTM-try/';
    this.page.title = 'A Demo of the CNN LSTM';
  };</script><!-- script(type='text/javascript' id='disqus-lazy-load-script').--><!--   $.ajax({--><!--   url: 'https://disqus.com/next/config.json',--><!--   timeout: 2500,--><!--   type: 'GET',--><!--   success: function(){--><!--     var d = document;--><!--     var s = d.createElement('script');--><!--     s.src = '//#{theme.disqus}.disqus.com/embed.js';--><!--     s.setAttribute('data-timestamp', + new Date());--><!--     (d.head || d.body).appendChild(s);--><!--     $('.disqus_click_btn').css('display', 'none');--><!--   },--><!--   error: function() {--><!--     $('.disqus_click_btn').css('display', 'block');--><!--   }--><!--   });--><script type="text/javascript" id="disqus-click-load">$('.btn_click_load').click(() => {  //click to load comments
    (() => { // DON'T EDIT BELOW THIS LINE
        var d = document;
        var s = d.createElement('script');
        s.src = '//neo1989.disqus.com/embed.js';
        s.setAttribute('data-timestamp', + new Date());
        (d.head || d.body).appendChild(s);
    })();
    $('.disqus_click_btn').css('display','none');
});</script><script type="text/javascript" id="disqus-count-script">$(function() {
     var xhr = new XMLHttpRequest();
     xhr.open('GET', '//disqus.com/next/config.json', true);
     xhr.timeout = 2500;
     xhr.onreadystatechange = function () {
       if (xhr.readyState === 4 && xhr.status === 200) {
         $('.post-meta .post-comments-count').show();
         var s = document.createElement('script');
         s.id = 'dsq-count-scr';
         s.src = 'https://neo1989.disqus.com/count.js';
         s.async = true;
         (document.head || document.body).appendChild(s);
       }
     };
     xhr.ontimeout = function () { xhr.abort(); };
     xhr.send(null);
   });
</script></div></div></div></div></div><div class="pure-u-1 pure-u-md-4-6"><div id="footer">Copyright © 2026 <a href="../../." rel="nofollow">愚苏记.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/i-yard/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho/maupassant"> Cho.</a></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="../../js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="../../lib/fancybox/3.5.7/jquery.fancybox.min.js" async></script><script type="text/javascript" src="../../js/fancybox.js?v=1.0.0" async></script><link rel="stylesheet" type="text/css" href="../../lib/fancybox/3.5.7/jquery.fancybox.min.css"><script type="text/javascript" src="../../js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="../../js/smartresize.js?v=1.0.0"></script><script type="text/javascript" id="maid-script" mermaidoptioins="{&quot;startOnload&quot;:true,&quot;theme&quot;:&quot;forest&quot;}" src="../../js/mermaid.min.js?v=1.0.0"></script><script>if (window.mermaid) {
  var options = JSON.parse(document.getElementById('maid-script').getAttribute('mermaidoptioins'));
  mermaid.initialize(options);
}</script></div><!-- hexo-inject:begin --><!-- hexo-inject:end --></body></html>